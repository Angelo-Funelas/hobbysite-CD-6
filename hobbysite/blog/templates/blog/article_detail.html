{% extends 'base.html' %}

{% block title %}{{ article.title }}{% endblock %}

{% block content %}
    <h2>{{ article.title }}</h2>

    {% if article.header_image %}
        <img src="{{ article.header_image.url }}" alt="Header Image" style="max-width: 100%;">
    {% endif %}

    <p><strong>Category:</strong> {{ article.category.name }}</p>
    <p>{{ article.entry }}</p>
    <p><small>Created on: {{ article.created_on }}</small></p>
    <p><small>Last updated on: {{ article.updated_on }}</small></p>

    {% if user.is_authenticated and article.author == user.profile %}
        <p><a href="{% url 'blog:article_update' article.id %}">Edit Article</a></p>
    {% endif %}

    <hr>

    <h3>Related Articles</h3>
    <ul>
        {% for related_article in related_articles %}
            <li><a href="{% url 'blog:article_detail' related_article.id %}">{{ related_article.title }}</a></li>
        {% empty %}
            <li>No related articles found.</li>
        {% endfor %}
    </ul>

    <hr>

    <h3>Comments</h3>
    {% for comment in comments %}
        <div>
            <strong>{{ comment.author.display_name }}</strong> ({{ comment.created_on }})<br>
            {{ comment.entry }}
        </div>
    {% empty %}
        <p>No comments yet.</p>
    {% endfor %}

    {% if user.is_authenticated %}
        <h3>Leave a Comment</h3>
        <form method="post">
            {% csrf_token %}
            {{ comment_form.as_p }}
            <button type="submit">Post Comment</button>
        </form>
    {% else %}
        <p><a href="{% url 'login' %}">Log in</a> to leave a comment.</p>
    {% endif %}

    <p><a href="{% url 'blog:index' %}">Back to Articles</a></p>
{% endblock %}
